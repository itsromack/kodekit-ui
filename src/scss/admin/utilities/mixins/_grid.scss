// Grid

@mixin setGridItemWidth($k-breakpoint,$k-columns) {
  @media (min-width: $k-breakpoint ) {
    width: percentage(1/$k-columns);
    @content;
  }
}

// Calculate the grid items
@mixin setGridBreakpoint($k-width: $k-grid-itemWidth, $k-spacing: $k-grid-spacing, $k-gridwidth: $k-grid-width) {

  // Calculating max number
  $k-number: floor($k-gridwidth / $k-width);

  // From 2 to 20 columns
  @for $k-i from 2 through $k-number {

    // Calculating breakpoint
    $k-prev-breakpoint-width: (($k-i - 1) * $k-width) + ($k-i * $k-spacing);
    $k-breakpoint-width: ($k-i * $k-width) + (($k-i + 1) * $k-spacing);
    $k-columns: $k-i;
    $k-breakpoint: $k-breakpoint-width;

    // Setting separate breakpoint for $k-desktop width
    @if ( $k-breakpoint-width > $k-desktop and $k-prev-breakpoint-width < $k-desktop ) {
      $k-breakpoint: $k-desktop;
      $k-columns: floor(($k-desktop - $k-sidebar-left-width-small - $k-spacing) / ($k-width + $k-spacing));
      @include setGridItemWidth($k-breakpoint,$k-columns);
    }

    // All breakpoints above $k-desktop
    @if ( $k-breakpoint-width > $k-desktop and $k-breakpoint-width < $k-delta ) {
      $k-columns: floor(($k-breakpoint-width - $k-sidebar-left-width-small - $k-spacing) / ($k-width + $k-spacing));
      $k-breakpoint: $k-sidebar-left-width-small + (($k-columns * $k-width) + (($k-columns + 1) * $k-spacing));
      @if ( $k-breakpoint < $k-desktop ) {
        $k-breakpoint: $k-breakpoint + ($k-width + $k-spacing);
      }
    }

    // Setting separate breakpoint for $k-delta width
    @if ( $k-breakpoint-width > $k-delta and $k-prev-breakpoint-width < $k-delta ) {
      $k-breakpoint: $k-delta;
      $k-columns: floor(($k-delta - $k-sidebar-left-width - $k-spacing) / ($k-width + $k-spacing));
      @include setGridItemWidth($k-breakpoint,$k-columns);
    }

    // All breakpoints above $k-delta
    @if ( $k-breakpoint-width > $k-delta ) {
      $k-columns: floor(($k-breakpoint-width - $k-sidebar-left-width - $k-spacing) / ($k-width + $k-spacing));
      $k-breakpoint: $k-sidebar-left-width + (($k-columns * $k-width) + (($k-columns + 1) * $k-spacing));
      @if ( $k-breakpoint < $k-delta ) {
        $k-breakpoint: $k-breakpoint + ($k-width + $k-spacing);
      }
    }

    // Setting breakpoints
    @include setGridItemWidth($k-breakpoint,$k-columns);
  }
}


// Creates a wrapper for a series of columns
@mixin make-row($k-gutter: $k-grid-gutter-width) {
  margin-left:  ceil(($k-gutter / -2));
  margin-right: floor(($k-gutter / -2));
  @include clearfix;
}